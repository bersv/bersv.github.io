# Домашнее задание по теме "Основы SQL"

## Цели домашнего задания

- Закрепить на практике знания по функциям агрегации и группировке строк.
- Научиться фильтровать сгруппированные строки.
- Закрепить навыки использования методов соединения таблиц с помощью разных вариаций JOIN.

## Перечень заданий

### Основная часть

### Задание 1
Выведите для каждого покупателя его адрес, город и страну проживания.

### Задание 2
С помощью SQL-запроса посчитайте для каждого магазина количество его покупателей.
Доработайте запрос и выведите только те магазины, у которых количество покупателей больше 300. Для решения используйте фильтрацию по сгруппированным строкам с функцией агрегации. Доработайте запрос, добавив в него информацию о городе магазина, фамилии и имени продавца, который работает в нём.

### Задание 3
Выведите топ-5 покупателей, которые взяли в аренду за всё время наибольшее количество фильмов.

### Задание 4
Посчитайте для каждого покупателя 4 аналитических показателя:
- количество взятых в аренду фильмов;
- Общую стоимость платежей за аренду всех фильмов (значение округлите до целого числа);
- Минимальное значение платежа за аренду фильма;
- Максимальное значение платежа за аренду фильма.

### Задание 5
Используя данные из таблицы городов, составьте все возможные пары городов так, чтобы в результате не было пар с одинаковыми названиями городов. Задание необходимо выполнить, используя Декартово произведение.

### Задание 6
Используя данные из таблицы rental о дате выдачи фильма в аренду (поле rental_date) и дате возврата (поле return_date), вычислите для каждого покупателя среднее количество дней, за которые он возвращает фильмы. В результате должны быть дробные значения, а не интервал.

### Дополнительная часть

### Задание 1
Посчитайте для каждого фильма, сколько раз его брали в аренду, а также общую стоимость аренды фильма за всё время.

### Задание 2
Доработайте запрос из предыдущего задания и выведите с помощью него фильмы, которые отсутствуют на dvd-дисках.

### Задание 3
Посчитайте количество продаж, выполненных каждым продавцом. Добавьте вычисляемую колонку "Премия". Если количество продаж превышает 7300, то значение в колонке будет "Да", иначе должно быть значение "Нет".

### Решение
[Файл с запросами](/Projects/01_SQL/Study_tasks/Task_2/Solution.sql)
