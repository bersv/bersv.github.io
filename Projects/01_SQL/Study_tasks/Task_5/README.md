# Домашнее задание по теме « Работа с PostgreSQL (часть 2)»

## Цели домашнего задания:

- Закрепить навыки использования функций и операторов языка SQL по поиску значений в массиве;
- Продемонстрировать работу с материализованными представлениями;
- Научиться строить и анализировать план выполнения запросов.

## Перечень заданий

### Основная часть:

__Задание 1.__ Напишите SQL-запрос, который выводит всю информацию о фильмах со специальным атрибутом “Behind the Scenes”.

__Задание 2.__ Напишите ещё 2 варианта поиска фильмов с атрибутом “Behind the Scenes”, используя другие функции или операторы языка SQL для поиска значения в массиве.

__Задание 3.__ Для каждого покупателя посчитайте, сколько он брал в аренду фильмов со специальным атрибутом “Behind the Scenes”.
Обязательное условие для выполнения задания: используйте запрос из задания 1, помещённый в CTE.

__Задание 4.__ Для каждого покупателя посчитайте, сколько он брал в аренду фильмов со специальным атрибутом “Behind the Scenes”.
Обязательное условие для выполнения задания: используйте запрос из задания 1, помещённый в подзапрос, который необходимо использовать для решения задания.

__Задание 5.__ Создайте материализованное представление с запросом из предыдущего задания и напишите запрос для обновления материализованного представления.

__Задание 6.__ С помощью explain analyze проведите анализ стоимости выполнения запросов из предыдущих заданий и ответьте на вопросы:
- С каким оператором или функцией языка SQL, используемыми при выполнении домашнего задания, поиск значения в массиве затрачивает меньше ресурсов системы;
- Какой вариант вычислений затрачивает меньше ресурсов системы: с использованием CTE или с использованием подзапроса.

### Дополнительная часть:

__Задание 1.__ Используя оконную функцию, выведите для каждого сотрудника сведения о первой его продаже.

__Задание 2.__ Для каждого магазина определите и выведите одним SQL-запросом следующие аналитические показатели:
- день, в который арендовали больше всего фильмов (в формате год-месяц-день);
- количество фильмов, взятых в аренду в этот день;
- день, в который продали фильмов на наименьшую сумму (в формате год-месяц-день);
- сумму продажи в этот день.

### Решение
[Файл с запросами](/Projects/01_SQL/Study_tasks/Task_5/Solution.sql)
