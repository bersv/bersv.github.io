# Домашнее задание по теме "Работа с PostgreSQL" (часть 2)

## Основная часть

### Задание 1
Напишите SQL-запрос, который выводит всю информацию о фильмах со специальным атрибутом “Behind the Scenes”.

### Задание 2
Напишите ещё 2 варианта поиска фильмов с атрибутом “Behind the Scenes”, используя другие функции или операторы языка SQL для поиска значения в массиве.

### Задание 3
Для каждого покупателя посчитайте, сколько он брал в аренду фильмов со специальным атрибутом “Behind the Scenes”.
Обязательное условие для выполнения задания: используйте запрос из задания 1, помещённый в CTE.

### Задание 4
Для каждого покупателя посчитайте, сколько он брал в аренду фильмов со специальным атрибутом “Behind the Scenes”.
Обязательное условие для выполнения задания: используйте запрос из задания 1, помещённый в подзапрос, который необходимо использовать для решения задания.

### Задание 5
Создайте материализованное представление с запросом из предыдущего задания и напишите запрос для обновления материализованного представления.

### Задание 6
С помощью explain analyze проведите анализ стоимости выполнения запросов из предыдущих заданий и ответьте на вопросы:
- С каким оператором или функцией языка SQL, используемыми при выполнении домашнего задания, поиск значения в массиве затрачивает меньше ресурсов системы;
- Какой вариант вычислений затрачивает меньше ресурсов системы: с использованием CTE или с использованием подзапроса.

## Дополнительная часть

### Задание 1
Используя оконную функцию, выведите для каждого сотрудника сведения о первой его продаже.

### Задание 2
Для каждого магазина определите и выведите одним SQL-запросом следующие аналитические показатели:
- день, в который арендовали больше всего фильмов (в формате год-месяц-день);
- количество фильмов, взятых в аренду в этот день;
- день, в который продали фильмов на наименьшую сумму (в формате год-месяц-день);
- сумму продажи в этот день.

### Решение
[Файл с запросами](/Projects/01_SQL/Study_tasks/Task_5/Solution.sql)
