# Домашнее задание по теме «Работа с PostgreSQL» (часть 1)

## Цель домашнего задания:
Закрепить навыки работы с оконными функциями, табличными выражениями и подзапросами.

## Перечень заданий

### Основная часть:

__Задание 1.__ Сделайте запрос к таблице payment и с помощью оконных функций добавьте вычисляемые колонки согласно условиям:

- Пронумеруйте все платежи от 1 до N по дате платежа;
- Пронумеруйте платежи для каждого покупателя, сортировка платежей должна быть по дате платежа;
- Посчитайте нарастающим итогом сумму всех платежей для каждого покупателя, сортировка должна быть сперва по дате платежа, а затем по размеру платежа от наименьшей к большей;
- Пронумеруйте платежи для каждого покупателя по размеру платежа от наибольшего к меньшему так, чтобы платежи с одинаковым значением имели одинаковое значение номера;
- Можно составить на каждый пункт отдельный SQL-запрос, а можно объединить все колонки в одном запросе.

__Задание 2.__ С помощью оконной функции выведите для каждого покупателя стоимость платежа и стоимость платежа из предыдущей строки со значением по умолчанию 0.0 с сортировкой по дате платежа.

__Задание 3.__ С помощью оконной функции определите, на сколько каждый следующий платеж покупателя больше или меньше текущего.

__Задание 4.__ С помощью оконной функции для каждого покупателя выведите данные о его последней оплате аренды.

### Дополнительная часть:

__Задание 1.__ С помощью оконной функции выведите для каждого сотрудника сумму продаж за август 2005 года с нарастающим итогом по каждому сотруднику и по каждой дате продажи (без учёта времени) с сортировкой по дате.

__Задание 2.__ 20 августа 2005 года в магазинах проходила акция: покупатель каждого сотого платежа получал дополнительную скидку на следующую аренду. С помощью оконной функции выведите всех покупателей, которые в день проведения акции получили скидку.

__Задание 3.__ Для каждой страны определите и выведите одним SQL-запросом покупателей, которые попадают под условия:
- покупатель, арендовавший наибольшее количество фильмов;
- покупатель, арендовавший фильмов на самую большую сумму;
- покупатель, который последним арендовал фильм.

### Решение
[Файл с запросами](/Projects/SQL/Study_task_4/Solution.sql)
